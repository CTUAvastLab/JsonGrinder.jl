<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Schema · JsonGrinder.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img class="docs-light-only" src="../../../assets/logo.svg" alt="JsonGrinder.jl logo"/><img class="docs-dark-only" src="../../../assets/logo-dark.svg" alt="JsonGrinder.jl logo"/></a><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../schema/">Schema</a></li><li><a class="tocitem" href="../../../extractors/">Creating extractors</a></li><li><a class="tocitem" href="../../../exfunctions/">Extractors overview</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../../examples/">Examples Overview</a></li><li><a class="tocitem" href="../../../examples/mutagenesis/">Mutagenesis Example</a></li><li><a class="tocitem" href="../../../examples/recipes/">Recipe Ingredients Example</a></li><li><a class="tocitem" href="../../../examples/schema_examination/">Schema Examination</a></li><li><a class="tocitem" href="../../../examples/schema_visualization/">Schema Visualization</a></li></ul></li><li><a class="tocitem" href="../../../automl/">AutoML</a></li><li><a class="tocitem" href="../../../hierarchical/">External tools</a></li><li><span class="tocitem">API Documentation</span><ul><li><a class="tocitem" href="../../public/">Public</a></li><li><input class="collapse-toggle" id="menuitem-8-2" type="checkbox" checked/><label class="tocitem" for="menuitem-8-2"><span class="docs-label">Internal</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Schema</a><ul class="internal"><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Internal-functions"><span>Internal functions</span></a></li></ul></li><li><a class="tocitem" href="../extractors/">Extractors</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../developers/">Developers</a></li><li><a class="tocitem" href="../../../citation/">Citation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Documentation</a></li><li><a class="is-disabled">Internal</a></li><li class="is-active"><a href>Schema</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Schema</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CTUAvastLab/JsonGrinder.jl/blob/master/docs/src/api/internal/schema.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Schema-API-Reference"><a class="docs-heading-anchor" href="#Schema-API-Reference">Schema API Reference</a><a id="Schema-API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Schema-API-Reference" title="Permalink"></a></h1><p>Section of internal API reference related to creation, manipulation and visualization of the schema.</p><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#JsonGrinder.ArrayEntry"><code>JsonGrinder.ArrayEntry</code></a></li><li><a href="#JsonGrinder.DictEntry"><code>JsonGrinder.DictEntry</code></a></li><li><a href="#JsonGrinder.Entry"><code>JsonGrinder.Entry</code></a></li><li><a href="#JsonGrinder.MultiEntry"><code>JsonGrinder.MultiEntry</code></a></li><li><a href="#Base.delete!"><code>Base.delete!</code></a></li><li><a href="#Base.merge"><code>Base.merge</code></a></li><li><a href="#JsonGrinder.newentry"><code>JsonGrinder.newentry</code></a></li><li><a href="#JsonGrinder.prune_json"><code>JsonGrinder.prune_json</code></a></li><li><a href="#JsonGrinder.update!"><code>JsonGrinder.update!</code></a></li><li><a href="#JsonGrinder.updatemaxkeys!"><code>JsonGrinder.updatemaxkeys!</code></a></li><li><a href="#JsonGrinder.updatemaxlen!"><code>JsonGrinder.updatemaxlen!</code></a></li></ul><h2 id="Internal-functions"><a class="docs-heading-anchor" href="#Internal-functions">Internal functions</a><a id="Internal-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Base.delete!" href="#Base.delete!"><code>Base.delete!</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Deletes <code>field</code> at the specified <code>path</code> from the schema <code>sch</code>. For instance, the following: 	<code>delete!(schema, &quot;.field.subfield.[]&quot;, &quot;x&quot;)</code> deletes the field <code>x</code> from <code>schema</code> at: 	<code>schema.childs[:field].childs[:subfield].items.childs</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CTUAvastLab/JsonGrinder.jl/blob/2b4f509a4a4c03af13f3d3be83d130154df96684/src/schema/schema.jl#L52-L58">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.merge" href="#Base.merge"><code>Base.merge</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Dispatch of <code>Base.merge</code> on <code>JsonGrinder.JSONEntry</code> structures. Allows to merge multiple schemas to single one.</p><pre><code class="nohighlight hljs">merge(es::Entry...)
merge(es::DictEntry...)
merge(es::ArrayEntry...)
merge(es::MultiEntry...)
merge(es::JsonGrinder.JSONEntry...)</code></pre><p>it can be used to distribute calculation of schema across multiple workers to merge their partial results into bigger one.</p><p><strong>Example</strong></p><p>If we want to calculate schema from e.g. array of jsons in a distributed manner, if we have <code>jsons</code> array and , we can do it using</p><pre><code class="language-julia hljs">using ThreadsX
ThreadsX.mapreduce(schema, merge, Iterators.partition(jsons, length(jsons) ÷ Threads.nthreads()))</code></pre><p>or</p><pre><code class="language-julia hljs">using ThreadTools
merge(tmap(schema, Threads.nthreads(), Iterators.partition(jsons, length(jsons) ÷ Threads.nthreads()))</code></pre><p>or, if you like to split it into multiple jobs and having them processed by multiple threads, it can look like</p><pre><code class="language-julia hljs">using ThreadTools
merge(tmap(schema, Threads.nthreads(), Iterators.partition(jsons, 1_000))</code></pre><p>where we split array to smaller array of size 1k and let all available threads create partial schemas.</p><p>If your data is too large to fit into ram, following approach works well also with filenames and similar other ways to process large data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CTUAvastLab/JsonGrinder.jl/blob/2b4f509a4a4c03af13f3d3be83d130154df96684/src/schema/dict.jl#L86-L119">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JsonGrinder.prune_json" href="#JsonGrinder.prune_json"><code>JsonGrinder.prune_json</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">prune_json(json, schema)</code></pre><p>Removes keys from <code>json</code> which are not part of the <code>schema</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using JSON

julia&gt; j1 = JSON.parse(&quot;{\&quot;a\&quot;: 4, \&quot;b\&quot;: {\&quot;a\&quot;:1, \&quot;b\&quot;: 1}}&quot;);

julia&gt; j2 = JSON.parse(&quot;{\&quot;a\&quot;: 4, \&quot;b\&quot;: {\&quot;a\&quot;:1}}&quot;);

julia&gt; sch = JsonGrinder.schema([j1,j2])
[Dict] 	# updated = 2
  ├── a: [Scalar - Int64], 1 unique values 	# updated = 2
  └── b: [Dict] 	# updated = 2
           ├── a: [Scalar - Int64], 1 unique values 	# updated = 2
           └── b: [Scalar - Int64], 1 unique values 	# updated = 1

julia&gt; j3 = Dict(&quot;a&quot; =&gt; 4, &quot;b&quot; =&gt; Dict(&quot;a&quot;=&gt;1), &quot;c&quot; =&gt; 1, &quot;d&quot; =&gt; 2)
Dict{String, Any} with 4 entries:
  &quot;c&quot; =&gt; 1
  &quot;b&quot; =&gt; Dict(&quot;a&quot;=&gt;1)
  &quot;a&quot; =&gt; 4
  &quot;d&quot; =&gt; 2

julia&gt; JsonGrinder.prune_json(j3, sch)
Dict{String, Any} with 2 entries:
  &quot;b&quot; =&gt; Dict(&quot;a&quot;=&gt;1)
  &quot;a&quot; =&gt; 4</code></pre><p>so the <code>JsonGrinder.prune_json</code> removes keys <code>c</code> and <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CTUAvastLab/JsonGrinder.jl/blob/2b4f509a4a4c03af13f3d3be83d130154df96684/src/schema/schema.jl#L67-L100">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JsonGrinder.newentry" href="#JsonGrinder.newentry"><code>JsonGrinder.newentry</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">newentry(v)</code></pre><p>creates new entry describing json according to the type of v</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CTUAvastLab/JsonGrinder.jl/blob/2b4f509a4a4c03af13f3d3be83d130154df96684/src/schema/makeschema.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JsonGrinder.update!" href="#JsonGrinder.update!"><code>JsonGrinder.update!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function update!(a::Entry, v)</code></pre><p>updates the entry when seeing value v</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CTUAvastLab/JsonGrinder.jl/blob/2b4f509a4a4c03af13f3d3be83d130154df96684/src/schema/scalar.jl#L43-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JsonGrinder.updatemaxkeys!" href="#JsonGrinder.updatemaxkeys!"><code>JsonGrinder.updatemaxkeys!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">updatemaxkeys!(n::Int)

limits the maximum number of keys in statistics of nodes in JSON. Default value is 10_000.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CTUAvastLab/JsonGrinder.jl/blob/2b4f509a4a4c03af13f3d3be83d130154df96684/src/switches.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JsonGrinder.updatemaxlen!" href="#JsonGrinder.updatemaxlen!"><code>JsonGrinder.updatemaxlen!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">updatemaxlen!(n::Int)

limits the maximum size of string values in statistics of nodes in JSON. Default value is 10_000.
Longer strings will be trimmed and their length and hash will be appended to retain the uniqueness.
This is due to some strings being very long and causing the schema to be even order of magnitute larger than needed.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CTUAvastLab/JsonGrinder.jl/blob/2b4f509a4a4c03af13f3d3be83d130154df96684/src/switches.jl#L13-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JsonGrinder.Entry" href="#JsonGrinder.Entry"><code>JsonGrinder.Entry</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct Entry &lt;: JSONEntry
	counts::Dict{Any,Int}
	updated::Int
end</code></pre><p>Keeps statistics about scalar values of a one key and also about items inside a key</p><ul><li><code>counts</code> counts how many times given value appeared (at most max_keys() is held)</li><li><code>updated</code> counts how many times the entry was updated</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CTUAvastLab/JsonGrinder.jl/blob/2b4f509a4a4c03af13f3d3be83d130154df96684/src/schema/scalar.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JsonGrinder.ArrayEntry" href="#JsonGrinder.ArrayEntry"><code>JsonGrinder.ArrayEntry</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct ArrayEntry &lt;: JSONEntry
	items
	l::Dict{Int,Int}
	updated::Int
end</code></pre><p>keeps statistics about an array entry in JSON.</p><ul><li><code>items</code> is typeof <code>Entry</code> or nothing and keeps statistics about the elements of the array</li><li><code>l</code> keeps histogram of message length</li><li><code>updated</code> counts how many times the struct was updated.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CTUAvastLab/JsonGrinder.jl/blob/2b4f509a4a4c03af13f3d3be83d130154df96684/src/schema/array.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JsonGrinder.MultiEntry" href="#JsonGrinder.MultiEntry"><code>JsonGrinder.MultiEntry</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct MultiEntry &lt;: JSONEntry
	childs::Vector{Any}
end</code></pre><p>support for JSON which does not adhere to a fixed type. Container for multiple types of entry which are observed on the same place in JSON.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CTUAvastLab/JsonGrinder.jl/blob/2b4f509a4a4c03af13f3d3be83d130154df96684/src/schema/multientry.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="JsonGrinder.DictEntry" href="#JsonGrinder.DictEntry"><code>JsonGrinder.DictEntry</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct DictEntry &lt;: JSONEntry
	childs::Dict{String, Any}
	updated::Int
end</code></pre><p>keeps statistics about an object in json</p><ul><li><code>childs</code> maintains key-value statistics of childrens. All values should be JSONEntries</li><li><code>updated</code> counts how many times the struct was updated.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CTUAvastLab/JsonGrinder.jl/blob/2b4f509a4a4c03af13f3d3be83d130154df96684/src/schema/dict.jl#L1-L10">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../public/">« Public</a><a class="docs-footer-nextpage" href="../extractors/">Extractors »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.14 on <span class="colophon-date" title="Tuesday 29 March 2022 09:56">Tuesday 29 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
